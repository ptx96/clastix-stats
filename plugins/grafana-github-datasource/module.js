/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","@grafana/runtime","emotion","app/core/core_module","lodash"],(function(e,t,n,r,a,o,i){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=7)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=a},function(e,t){e.exports=o},function(e,t){e.exports=i},function(e,t,n){"use strict";n.r(t);var r=n(2),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function l(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function l(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}function f(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var p=n(3),d=function(e,t,n,r){return t?e.replace(t,n,r):t},m=function(e,t,n){void 0===n&&(n={});var r=i({},e);return Object.keys(r).forEach((function(e){var a,o;"refId"!==e&&"string"==typeof r[e]&&(r=i(i({},r),"query"===e?((a={})[e]=d(t,r[e],n,"csv"),a):((o={})[e]=d(t,r[e],n),o)))})),r},h=function(e){return!!e.queryType},g={userId:"userId",login:"login",email:"email",avatarUrl:"avatarUrl",time:"time",timeEnd:"timeEnd",title:"title",text:"text",tags:"tags"};function y(e,t){var n,a,o,l,u,f,p,d=[];if(!e||!e.length)return d;var m=!1,h=!1,y={};try{for(var v=c(e.fields),b=v.next();!b.done;b=v.next()){y[(N=b.value).name.toLowerCase()]=N}}catch(e){n={error:e}}finally{try{b&&!b.done&&(a=v.return)&&a.call(v)}finally{if(n)throw n.error}}t=i({field:{},regex:{}},t);var E=[],w=i(i({},g),null==t?void 0:t.field);try{for(var C=c(Object.entries(w)),T=C.next();!T.done;T=C.next()){var q=s(T.value,2),O=q[0],x=q[1],k=x?x.toLowerCase():"";if(k&&y[k]){switch((Q={key:O,field:y[k]}).key){case"time":m=!0;break;case"text":h=!0;break;case"tags":Q.split=","}var j=t.regex[Q.key];j&&(Q.regex=new RegExp(j)),E.push(Q)}}}catch(e){o={error:e}}finally{try{T&&!T.done&&(l=C.return)&&l.call(C)}finally{if(o)throw o.error}}if(!m){if(!(F=e.fields.find((function(e){return e.type===r.FieldType.time}))))return[];E.push({key:"time",field:F})}if(!h){var F;if(!(F=e.fields.find((function(e){return e.type===r.FieldType.string}))))return[];var S={key:"text",field:F};(null===(p=null==t?void 0:t.regex)||void 0===p?void 0:p.text)&&(S.regex=new RegExp(t.regex.text)),E.push(S)}for(var P=0;P<e.length;P++){var R={};try{for(var I=(u=void 0,c(E)),A=I.next();!A.done;A=I.next()){var N,Q=(N=A.value).field.values.get(P);if(N.regex){var _=N.regex.exec(Q);_&&(Q=_[1]?_[1]:_[0])}N.split&&(Q=Q.split(",")),R[N.key]=Q}}catch(e){u={error:e}}finally{try{A&&!A.done&&(f=I.return)&&f.call(I)}finally{if(u)throw u.error}}d.push(R)}return d}var v,b,E,w,C=function(e){function t(t){var n=e.call(this,t)||this;return n.templateSrv=Object(p.getTemplateSrv)(),n.filterQuery=function(e){return h(e)},n}return o(t,e),t.prototype.applyTemplateVariables=function(e,t){return function(e,t,n){var r=i({},t);return r=m(r,e,n),t.options&&(r=i(i({},r),{options:m(t.options,e,n)})),r}(this.templateSrv,e,t)},t.prototype.getLabels=function(e,t,n){return l(this,void 0,Promise,(function(){return u(this,(function(r){return[2,this.getResource("labels",{repository:e,owner:t,query:n})]}))}))},t.prototype.annotationQuery=function(e){var t;return l(this,void 0,Promise,(function(){var n,r,a;return u(this,(function(o){switch(o.label){case 0:return n=e.annotation.annotation,r={targets:[i(i({},n),{datasourceId:this.id,refId:this.name})],range:e.range,interval:e.interval},[4,this.query(r).toPromise()];case 1:return a=o.sent(),(null===(t=null==a?void 0:a.data)||void 0===t?void 0:t.length)?[2,y(a.data[0],{field:{time:n.timeField,text:n.field||"name"}})]:[2,[]]}}))}))},t.prototype.getChoices=function(e){var t;return l(this,void 0,Promise,(function(){var n,r,a;return u(this,(function(o){switch(o.label){case 0:n={targets:[i(i({},e),{refId:"metricFindQuery"})],range:{to:{},from:{}}},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.query(n).toPromise()];case 2:return r=o.sent(),[2,(null===(t=r.data[0])||void 0===t?void 0:t.fields.map((function(e){return e.name})))||[]];case 3:return a=o.sent(),[2,Promise.reject(a)];case 4:return[2]}}))}))},t.prototype.metricFindQuery=function(e,t){return l(this,void 0,Promise,(function(){var n,a,o;return u(this,(function(l){switch(l.label){case 0:n={targets:[i(i({},e),{refId:"metricFindQuery"})],range:t.range,rangeRaw:t.rangeRaw},l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.query(n).toPromise()];case 2:return a=l.sent(),[3,4];case 3:return o=l.sent(),[2,Promise.reject(o)];case 4:return!a||!a.data||a.data.length<0?[2,[]]:[2,new r.DataFrameView(a.data[0]).map((function(t){return{text:t[e.field||"name"]}}))]}}))}))},t}(p.DataSourceWithBackend),T=n(0),q=n.n(T),O=n(1),x={ConfigEditor:{AccessToken:{input:"Config editor access token"}},QueryEditor:{Owner:{input:"Query editor owner"},Repository:{input:"Query editor repository"},Query:{input:"Query editor query"},Ref:{input:"Query editor ref"}},AnnotationEditor:{container:"Annotation editor container"}},k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSettingReset=function(e){return function(n){t.onSettingUpdate(e,!1)({target:{value:void 0}})}},t.onSettingUpdate=function(e,n){return void 0===n&&(n=!0),function(r){var a,o,l=t.props,u=l.onOptionsChange,c=l.options;u(i(i({},c),{secureJsonData:i(i({},c.secureJsonData),(a={},a[e]=r.target.value,a)),secureJsonFields:i(i({},c.secureJsonFields),(o={},o[e]=n,o))}))}},t}return o(t,e),t.prototype.render=function(){var e=this.props.options,t=e.jsonData,n=e.secureJsonData,a=e.secureJsonFields,o=n||{};return q.a.createElement(q.a.Fragment,null,q.a.createElement(O.InfoBox,{title:"Access Token Permissions"},q.a.createElement("p",null,"To create a new Access Token, navigate to"," ",q.a.createElement("a",{href:"https://github.com/settings/tokens"},"Personal Access Tokens ",q.a.createElement(O.Icon,{name:"link"}))," ",'and create a click "Generate new token."'),q.a.createElement("p",null,"Ensure that your token has the following permissions:"),q.a.createElement("h4",null,"For all repositories:"),q.a.createElement("pre",null,q.a.createElement("ul",null,q.a.createElement("li",null,"public_repo"),q.a.createElement("li",null,"repo:status"),q.a.createElement("li",null,"repo_deployment"),q.a.createElement("li",null,"read:packages")),q.a.createElement("ul",null,q.a.createElement("li",null,"read:user"),q.a.createElement("li",null,"user:email"))),q.a.createElement("h4",null,"An extra setting is required for private repositories:"),q.a.createElement("pre",null,q.a.createElement("ul",null,q.a.createElement("li",null,"repo (Full control of private repositories)")))),q.a.createElement("div",{className:"gf-form-group"},q.a.createElement("h3",{className:"page-heading"},"Service Account Access"),q.a.createElement("div",{className:"gf-form"},q.a.createElement(O.LegacyForms.SecretFormField,{"aria-label":x.ConfigEditor.AccessToken.input,label:"Access Token",inputWidth:27,labelWidth:10,onChange:this.onSettingUpdate("accessToken",!1),onBlur:this.onSettingUpdate("accessToken"),value:o.accessToken||"",placeholder:"Github Personal Access Token",onReset:this.onSettingReset("accessToken"),isConfigured:a.accessToken}))),q.a.createElement("div",{className:"gf-form-group"},q.a.createElement("h3",{className:"page-heading"},"GitHub Enterprise"),q.a.createElement("div",{className:"gf-form"},q.a.createElement(O.InlineFormLabel,{className:"width-10"},"GitHub Enterprise URL"),q.a.createElement(O.Input,{css:"",className:"width-27",value:t.githubUrl,placeholder:"URL of GitHub Enterprise",summary:"URL for GitHub Enterprise, such as https://github.company.com, leave blank if using github.com",onChange:Object(r.onUpdateDatasourceJsonDataOption)(this.props,"githubUrl")}))),q.a.createElement(O.InfoBox,{title:"GitHub Enterprise"},q.a.createElement("p",null,"For GitHub Enterprise enter the URL, such as https://github.company.com"),q.a.createElement("p",null,"Leave blank if not using GitHub Enterprise, which will default to github.com")))},t}(T.PureComponent);!function(e){e.Commits="Commits",e.Issues="Issues",e.Contributors="Contributors",e.Tags="Tags",e.Releases="Releases",e.Pull_Requests="Pull_Requests",e.Labels="Labels",e.Repositories="Repositories",e.Organizations="Organizations",e.GraphQL="GraphQL",e.Milestones="Milestones",e.Packages="Packages"}(v||(v={})),function(e){e.NPM="NPM",e.RUBYGEMS="RUBYGEMS",e.MAVEN="MAVEN",e.DOCKER="DOCKER",e.DEBIAN="DEBIAN",e.NUGET="NUGET",e.PYPI="PYPI"}(b||(b={})),function(e){e[e.ClosedAt=0]="ClosedAt",e[e.CreatedAt=1]="CreatedAt",e[e.MergedAt=2]="MergedAt",e[e.None=3]="None"}(E||(E={})),function(e){e[e.CreatedAt=0]="CreatedAt",e[e.ClosedAt=1]="ClosedAt"}(w||(w={}));var j,F,S,P=v.Issues,R=function(e){var t=e.label,n=e.labelWidth,r=void 0===n?8:n,a=e.tooltip,o=e.children;return q.a.createElement(q.a.Fragment,null,q.a.createElement(O.InlineFormLabel,{width:r,className:"query-keyword",tooltip:a},t),o)},I=function(){return q.a.createElement("div",{className:"gf-form gf-form--grow"},q.a.createElement("div",{className:"gf-form-label gf-form-label--grow"}))},A=function(e){var t=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,[]);return q.a.createElement(N,null,q.a.createElement(R,i({},t)))},N=function(e){return q.a.createElement("div",{className:"gf-form-inline"},e.children,q.a.createElement(I,null))},Q=function(e){var t=s(Object(T.useState)(e.repository||""),2),n=t[0],r=t[1],a=s(Object(T.useState)(e.owner||""),2),o=a[0],l=a[1];return q.a.createElement(N,null,q.a.createElement(O.InlineFormLabel,{className:"query-keyword",tooltip:"The owner (organization or user) of the GitHub repository (example: 'grafana')",width:X},"Owner"),q.a.createElement(O.Input,{"aria-label":x.QueryEditor.Owner.input,css:"",width:Z,value:o,onChange:function(e){return l(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e),{owner:t.currentTarget.value}))}}),q.a.createElement(O.InlineFormLabel,{className:"query-keyword",tooltip:"The name of the GitHub repository",width:X},"Repository"),q.a.createElement(O.Input,{"aria-label":x.QueryEditor.Repository.input,css:"",width:Z,value:n,onChange:function(e){return r(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e),{repository:t.currentTarget.value}))}}))},_=function(){return q.a.createElement(q.a.Fragment,null)},L=function(e){var t=s(Object(T.useState)(e.gitRef||""),2),n=t[0],r=t[1];return q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{labelWidth:X,label:"Ref (Branch / Tag)"},q.a.createElement(O.Input,{"aria-label":x.QueryEditor.Ref.input,css:"",width:Z,value:n,onChange:function(e){return r(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e),{gitRef:t.currentTarget.value}))}})))},M=Object.keys(w).filter((function(e,t){return void 0!==w[t]})).map((function(e,t){return{label:""+w[t],value:t}})),W=function(e){var t=s(Object(T.useState)(e.query||""),2),n=t[0],r=t[1];return q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{labelWidth:X,label:"Query",tooltip:"For more information, visit https://docs.github.com/en/github/searching-for-information-on-github/searching-issues-and-pull-requests"},q.a.createElement(O.Input,{css:"",value:n,width:2*Z+X,onChange:function(e){return r(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e),{query:t.currentTarget.value}))}})),q.a.createElement(A,{labelWidth:X,label:"Time Field",tooltip:"The time field to filter on th time range"},q.a.createElement(O.Select,{width:Z,options:M,value:e.timeField||0,onChange:function(t){return e.onChange(i(i({},e),{timeField:t.value}))}})))},G=function(e){var t=s(Object(T.useState)(e.query||""),2),n=t[0],r=t[1];return q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{labelWidth:X,label:"Query",tooltip:"Query milestones by title"},q.a.createElement(O.Input,{css:"",value:n,width:2*Z+X,onChange:function(e){return r(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e),{query:t.currentTarget.value}))}})))},U=Object.keys(E).filter((function(e,t){return void 0!==E[t]})).map((function(e,t){return{label:""+E[t],value:t}})),B=U[0].value,D=function(e){var t=s(Object(T.useState)(e.query||""),2),n=t[0],r=t[1];return q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{labelWidth:X,label:"Query",tooltip:"For more information, visit https://docs.github.com/en/github/searching-for-information-on-github/searching-issues-and-pull-requests"},q.a.createElement(O.Input,{css:"",value:n,width:Z,onChange:function(e){return r(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e),{query:t.currentTarget.value}))}})),q.a.createElement(A,{labelWidth:X,label:"Time Field",tooltip:"The time field to filter on the time range. WARNING: If selecting 'None', be mindful of the amount of data being queried. On larger repositories, querying all pull requests could easily cause rate limiting"},q.a.createElement(O.Select,{width:Z,options:U,value:e.timeField||B,onChange:function(t){return e.onChange(i(i({},e),{timeField:t.value}))}})))},H=function(){return q.a.createElement(q.a.Fragment,null)},J=function(e){var t=s(Object(T.useState)(e.query||""),2),n=t[0],r=t[1];return q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{labelWidth:X,label:"Query (optional)"},q.a.createElement(O.Input,{css:"",width:Z,value:n,onChange:function(e){return r(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e),{query:t.currentTarget.value}))}})))},V=function(e){var t=s(Object(T.useState)(e.query||""),2),n=t[0],r=t[1];return q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{labelWidth:X,label:"Query (optional)"},q.a.createElement(O.Input,{css:"",width:Z,value:n,onChange:function(e){return r(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e),{query:t.currentTarget.value}))}})))},Y=b.NPM,z=Object.keys(b).map((function(e){return{label:e.replace("/_/gi"," "),value:e}})),K=function(e){var t=s(Object(T.useState)(e.names||""),2),n=t[0],r=t[1];return q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{labelWidth:X,label:"Package type"},q.a.createElement(O.Select,{options:z,value:e.packageType||Y,width:Z,onChange:function(t){return e.onChange(i(i({},e),{packageType:t.value}))}})),q.a.createElement(A,{labelWidth:X,label:"Names",tooltip:"Search for packages using a comma delimited list of names"},q.a.createElement(O.Input,{css:"",value:n,width:2*Z+X,onChange:function(e){return r(e.currentTarget.value)},onBlur:function(t){return e.onChange(i(i({},e.query),{names:t.currentTarget.value}))}})))},X=10,Z=36,$=((j={})[v.Repositories]={component:function(e,t){return q.a.createElement(q.a.Fragment,null)}},j[v.Labels]={component:function(e,t){return q.a.createElement(V,i({},e.query.options||{},{onChange:t}))}},j[v.Contributors]={component:function(e,t){return q.a.createElement(J,i({},e.query.options||{},{onChange:t}))}},j[v.Tags]={component:function(e,t){return q.a.createElement(H,i({},e.query.options||{}))}},j[v.Releases]={component:function(e,t){return q.a.createElement(_,i({},e.query.options||{}))}},j[v.Commits]={component:function(e,t){return q.a.createElement(L,i({},e.query.options||{},{onChange:t}))}},j[v.Milestones]={component:function(e,t){return q.a.createElement(G,i({},e.query.options||{},{onChange:t}))}},j[v.Issues]={component:function(e,t){return q.a.createElement(W,i({},e.query.options||{},{onChange:t}))}},j[v.Packages]={component:function(e,t){return q.a.createElement(K,i({},e.query.options||{},{onChange:t}))}},j[v.Pull_Requests]={component:function(e,t){return q.a.createElement(D,i({},e.query.options||{},{onChange:t}))}},j),ee=Object.keys(v).map((function(e){return{label:e.replace(/_/gi," "),value:e}})),te=function(e){var t=Object(T.useCallback)((function(t){e.onChange(t),h(t)&&e.onRunQuery()}),[e]),n=Object(T.useCallback)((function(n,r){var a;t(i(i({},e.query),((a={})[n]=r,a)))}),[t,e.query]),r=$[e.query.queryType||P],a=e.queryTypes||Object.keys($);return q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{label:"Query Type",tooltip:"What resource are you querying for?",labelWidth:X},q.a.createElement(O.Select,{width:Z,options:ee.filter((function(e){return a.includes(e.value)})),value:e.query.queryType,onChange:function(e){return n("queryType",e.value||P)}})),q.a.createElement(Q,{repository:e.query.repository,owner:e.query.owner,onChange:function(n){t(i(i({},e.query),n))}}),r?r.component(e,(function(e){return n("options",e||void 0)})):q.a.createElement("span",null,"Unsupported Query Type"))},ne=n(4),re=Object(ne.css)(F||(F=f(["\n  align-items: center;\n"],["\n  align-items: center;\n"]))),ae=Object(ne.css)(S||(S=f(["\n  margin: 0px 3px;\n  padding: 0px 3px;\n"],["\n  margin: 0px 3px;\n  padding: 0px 3px;\n"]))),oe=function(e){var t=e.onChange,n=e.options,r=e.value,a=e.width,o=e.loading;return q.a.createElement("div",{className:re+" gf-form-inline"},q.a.createElement(O.Select,{value:r,onChange:function(e){return t(e.value)},width:a,disabled:o,placeholder:o?"Loading...":"Select...",options:n.map((function(e){return{label:e,value:e}}))}),o&&q.a.createElement("div",null,q.a.createElement(O.Spinner,{className:ae})))},ie=function(e){var t=e.datasource.name+" - "+(e.query.queryType||P),n=s(Object(T.useState)(),2),r=n[0],a=n[1];return Object(T.useMemo)((function(){return l(void 0,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return h(e.query)?(t=a,[4,e.datasource.getChoices(e.query)]):[3,2];case 1:t.apply(void 0,[n.sent()]),n.label=2;case 2:return[2]}}))}))}),[e.query,e.datasource]),q.a.createElement(q.a.Fragment,null,q.a.createElement(te,{query:e.query,datasource:e.datasource,onChange:function(n){return e.onChange(i(i({},n),{field:e.query.field}),t)},onRunQuery:function(){},queryTypes:[v.Repositories,v.Contributors,v.Tags,v.Releases,v.Labels,v.Milestones]}),q.a.createElement(A,{width:10,labelWidth:10,label:"Display Field",tooltip:"This field determines the text / value used for the variable"},q.a.createElement(oe,{onChange:function(n){return e.onChange(i(i({},e.query),{field:n}),t)},options:r||[],width:64,value:e.query.field,loading:!r})))},le=n(5),ue=function(e){var t=s(Object(T.useState)(),2),n=t[0],r=t[1],a=e.annotation;Object(T.useMemo)((function(){return l(void 0,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return h(e.annotation.annotation)?(t=r,[4,e.datasource.getChoices(e.annotation.annotation)]):[3,2];case 1:t.apply(void 0,[n.sent()]),n.label=2;case 2:return[2]}}))}))}),[e.annotation.annotation,e.datasource]);var o=Object(T.useCallback)((function(t){e.change(i(i({},e.annotation),{annotation:i(i(i({},a.annotation),t),{datasource:e.datasource.name})}))}),[e,a.annotation]);return q.a.createElement("div",{"aria-label":x.AnnotationEditor.container},q.a.createElement(te,{query:a.annotation,datasource:e.datasource,onChange:function(e){return o(i(i({},e),{field:a.annotation.field}))},onRunQuery:function(){},queryTypes:[v.Commits,v.Releases,v.Pull_Requests,v.Issues,v.Milestones,v.Tags]}),h(e.annotation.annotation)&&q.a.createElement(q.a.Fragment,null,q.a.createElement(A,{width:10,labelWidth:10,label:"Display Field",tooltip:"This field determines the text / value displayed on the annotation"},q.a.createElement(oe,{onChange:function(e){return o(i(i({},a.annotation),{field:e}))},options:n||[],width:64,value:a.annotation.field,loading:!n})),q.a.createElement(A,{width:10,labelWidth:10,label:"Time Field",tooltip:"This field is used to determine where the annotation will display on a graph"},q.a.createElement(oe,{onChange:function(e){return o(i(i({},a.annotation),{timeField:e}))},options:n||[],width:64,value:a.annotation.timeField,loading:!n}))))};n.n(le).a.directive("githubAnnotationEditor",["reactDirective",function(e){return e(ue,["annotation","datasource","change"])}]);var ce=n(6),se={queryType:P,refId:""},fe=function(){function e(){var e=this;this.onChange=function(t){e.annotation.annotation=t.annotation},this.annotation.annotation=Object(ce.defaultsDeep)(this.annotation.annotation,se),this.annotation.datasourceId=this.datasource.id}return e.templateUrl="partials/annotations.editor.html",e}();n.d(t,"plugin",(function(){return pe}));var pe=new r.DataSourcePlugin(C).setConfigEditor(k).setVariableQueryEditor(ie).setQueryEditor(te).setAnnotationQueryCtrl(fe)}])}));
//# sourceMappingURL=module.js.map